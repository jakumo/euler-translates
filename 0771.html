Subject:
Псевдогеометрические последовательности

Body:
<div class="problem_content">

<p>
Определим <i>псевдогеометрическую последовательность</i> как конечную последовательность положительных целых чисел $a_0, a_1, \dotsc, a_n$, отвечающую следующим условиям:
</p><ul>
<li>$n \geq 4$, т.е. последовательность содержит не менее 5 элементов.</li>
<li>$0 &lt; a_0 &lt; a_1 &lt; \dotsc &lt; a_n$, т.е. последовательность строго возрастающая.</li>
<li>$| a_i^2 - a_{i - 1}a_{i + 1} | \le 2$ для $1 \le i \le n-1$.</li>
</ul>
<p>
Пусть $G(N)$ будет количеством различных псевдогеометрических последовательностей, чьи элементы не превышают $N$.<br />
Например, $G(6) = 4$, так как следующие $4$ последовательности составляют исчерпывающий список:
</p><center>$1, 2, 3, 4, 5 \qquad 1, 2, 3, 4, 6 \qquad 2, 3, 4, 5, 6 \qquad 1, 2, 3, 4, 5, 6$ </center>
<p>
Также известно, что $G(10) = 26$, $G(100) = 4710$ и $G(1000) = 496805$.</p>
<p>
Найдите $G(10^{18})$. В качестве ответа приведите остаток от деления полученного результата на $1\,000\,000\,007$.</p>


</div>