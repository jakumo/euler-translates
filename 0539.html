Subject:
Нечетный отсев

Body:
<div class="problem_content">

<p>
Начните с упорядоченного списка всех целых чисел от 1 до <var>n</var>. Двигаясь слева направо, исключите из списка первое число и каждое второе следующее за ним число до конца списка. Повторите эту процедуру справа налево, исключая из списка самое правое число и каждое второе число налево от него. Продолжайте исключать из списка каждое второе число, меняя направление слева направо и справа налево, пока не останется одно единственное число.
</p>
<p>
Начав с <var>n</var> = 9, мы получим:<br /><u>1</u> 2 <u>3</u> 4 <u>5</u> 6 <u>7</u> 8 <u>9</u><br />
2 <u>4</u> 6 <u>8</u><br /><u>2</u> 6<br />
6
</p>
<p>
Пусть <var>P</var>(<var>n</var>) будет последним оставшимся числом из списка длиной <var>n</var>.<br />
Пусть $\displaystyle S(n) = \sum_{k=1}^n P(k)$.<br />
Вам дано, что P(1)=1, P(9) = 6, P(1000)=510, S(1000)=268271.
</p>
<p>
Найдите S(10<sup>18</sup>) mod 987654321.
</p>

</div>