Subject:
Тесты крови

Body:
<div class="problem_content">
<p>
Каждую 25-ю овцу из стада необходимо проверить на редкий вирус,
который поражает 2% популяции овец.
Существует точный и высокочувствительный ПЦР тест образцов крови,
который дает однозначный положительный/отрицательный результат, но он дорогой и очень затратный по времени.
</p>

<p>
Из-за высокой цены, главный ветеринар предлагает вместо 25 отдельных тестов
проводить следующую процедуру:<br/><br/>
Овец распределяют на 5 груп по 5 овец в каждой.
5 образцов крови каждой овцы из группы смешиваются вместе, после чего проводится один тест.
Тогда,</p>
<ul>
<li>Если результат отрицательный, то все овцы в этой группе считаются здоровыми.</li>
<li>Если результат положительный, проводится 5 дополнительных тестов. Отдельный тест для образца крови
        каждого животного, чтобы определить зараженных особей.</li>
</ul>

<p>
Поскольку вероятность заражения каждого отдельно взятого животного составляет всего 0,02,
то первый тест (объединенных образцов) для каждой группы будет:</p>
<ul>
<li>Отрицательным (и больше тестов не потребуется) с вероятностью 0.98<sup>5</sup> = 0,9039207968.</li>
<li>Положительным (потребуется 5 дополнительных тестов) с вероятностью 1 - 0,9039207968 = 0,0960792032.</li>
</ul>

<p>
Таким образом, ожидаемое количество тестов для каждой группы составвит 1 + 0,0960792032
<img src=' http://projecteuler.net/ images/symbol_times.gif' width='9' height='9' alt='&times;'
border='0' style='vertical-align:middle;' /> 5 = 1,480396016.<br/>
Следовательно, все 5 групп можно просеять со средним количеством тестов 1,480396016
<img src=' http://projecteuler.net/ images/symbol_times.gif' width='9' height='9' alt='&times;'
border='0' style='vertical-align:middle;' /> 5 = <b>7,40198008</b>,
что дает огромный выигрыш, более чем 70% !
</p>

<p>
Хотя описанная выше процедура выглядит очень эффективной, ее можно 
существенно улучшить (всегда предполагается, что тест достаточно чувствителен
и что нет никаких побочных эффектов при смешивании образцов крови). К примеру:</p>
<ul>
<li>Можно начать с теста смеси всех 25 образцов крови. Можно убедиться, что
примерно в 60,35% случаев тест будет отрицательным и дополнительные тесты не потребуются.
Более подробное тестирование потребуется лишь в оставшихся 39,65% случаев.</li>
<li>Если известно, что по крайней мере одно из животных в группе из 5 особей инфицировано, и что первые 4
индивидуальных теста дадут отрицательный результат, то совершенно не требуется проводить тест
для пятого животного (очевидно, что именно оно и будет инфицировано).</li>
<li>Можно попробовать изменить количество групп / количество особей в группе,
меняя эти числа на каждом уровне так, чтобы общее число проведенных тестов было минимальным.</li>
</ul>
<p>
Чтобы упростить очень широкий ряд возможностей, введем ограничение на получение наиболее эффективной
по затратам схемы тестирования: когда бы мы не тестировали смешанный образец, необходимо полностью
разделить всех овец, чьи образцы крови участвовали в тестировании (т.е. получить результат для каждого
животного из группы - инфицированно оно или нет), прежде чем можно будет проводить тестирование остальных
групп животных.
</p>
<p>
В данном примере оказывается, что наиболее эффективная по затратам методика тестирования
(будем называть ее <i>оптимальной стратегией</i>) потребует в среднем всего лишь <b>4,155452</b> тестов!
</p>

<p>
Для такой оптимальной стратегии определим T(<var>s</var>,<var>p</var>) как среднее количество тестов,
необходимое для отсеивания больных животных в стаде из <var>s</var> овец, при вероятности заболевания
каждой особи <var>p</var>.<br/>
Таким образом, округлив результат до шести знаков после запятой,
T(25, 0,02) = 4,155452 и T(25, 0,10) = 12.,702124.
</p>

<p>
Найдите &Sigma;T(10000, p) для всех p=0,01, 0,02, 0,03, ... 0,50.<br/>
Ответ округлите до шести знаков после запятой.
</p>
</div>