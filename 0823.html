Subject:
Перетасовка множителей

Body:
<div class="problem_content">

<p>Начнем со списка, содержащего числа $2, 3, \dots, n$.<br />
В каждой итерации каждое число списка делится на свой наименьший простой множитель. Затем произведение всех наименьших простых множителей добавляется в список в качестве нового элемента. Наконец все числа, ставшие $1$, удаляются из списка.</p>

<p>Например, ниже приведены первые три итерации для $n = 5$:
$$[2, 3, 4, 5] \xrightarrow{(1)} [2, 60] \xrightarrow{(2)} [30, 4] \xrightarrow{(3)} [15, 2, 4].$$
Пусть $S(n, m)$ будет суммой всех чисел в списке после $m$ итераций.<br />
Например, $S(5, 3) = 15 + 2 + 4 = 21$. Также известно, что $S(10, 100) = 257$.</p>

<p>Найдите $S(10^4, 10^{16})$. В качестве ответа приведите остаток от деления полученного результата на $1234567891$.</p>



</div>