Subject:
Пропорциональный ним

Body:
<div class="problem_content">

<p>Двое игроков играют в игру с двумя кучками камней.</p>
<p>В свой ход игрок выбирает натуральное число $n$ и делает следующее:</p>
<ul><li>убирает $n$ камней из одной кучки;</li>
<li>убирает $n$ камней из обеих кучек; или</li>
<li>убирает $n$ камней из одной кучки и $2n$ камней из другой кучки.</li>
</ul><p>Игрок, убравший последний камень, побеждает.</p>

<p>Обозначим $(n,m)$ расположение, в котором в кучках остается $n$ и $m$ камней соответственно. Заметим расположение, что $(n,m)$ считается идентичным расположению $(m,n)$.</p>

<p>Например, при расположении $(2,6)$ следующий игрок может достичь следующие расположения:<br />
$(0,2)$, $(0,4)$, $(0,5)$, $(0,6)$, $(1,2)$, $(1,4)$, $(1,5)$, $(1,6)$, $(2,2)$, $(2,3)$, $(2,4)$, $(2,5)$</p>

<p>Расположение является проигрышным, если игрок, чей ход следующий, не может достичь победы. Например, $(1,3)$, $(2,6)$, $(4,5)$ - это первые несколько проигрышных расположений.</p>

<p>Пусть $f(M)$ будет суммой $n+m$ для всех проигрышных расположений $(n,m)$ при $n\le m$ и $n+m \le M$. Например, $f(10) = 21$, если рассмотреть проигрышные расположения $(1,3)$, $(2,6)$, $(4,5)$.</p>
<p>Известно, что $f(100) = 1164$ и $f(1000) = 117002$.</p>

<p>Найдите $f(10^7)$.</p>

</div>