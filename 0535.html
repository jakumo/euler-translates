Subject:
Фрактальная последовательность

Body:
<div class="problem_content">

<p>Рассмотрим бесконечную последовательность S, начинающуюся так:<br /><var>S</var> = 1, 1, 2, 1, 3, 2, 4, 1, 5, 3, 6, 2, 7, 8, 4, 9, 1, 10, 11, 5, ...</p>

<p>Выделим для каждого целого числа его первое появление в последовательности:<br /><var>S</var> = <b>1</b>, 1, <b>2</b>, 1, <b>3</b>, 2, <b>4</b>, 1, <b>5</b>, 3, <b>6</b>, 2, <b>7</b>, <b>8</b>, 4, <b>9</b>, 1, <b>10</b>, <b>11</b>, 5, ...</p>

<p>Этой последовательности характерны следующие свойства:</p>
<ul><li>Выделенные числа - последовательные целые числа, начиная с 1.</li>
<li>Непосредественно перед каждым невыделенным числом <var>a<sub>i</sub></var> находится ровно └√<var>a<sub>i</sub></var>┘ прилегающих выделенных чисел, где └ ┘ - функция пола.</li>
<li>Если убрать все выделенные числа из последовательности, оставшиеся в ней числа сформируют последовательность, идентичную <var>S</var>. Таким образом, <var>S</var> - это <b>фрактальная последовательность</b>.</li></ul>

<p>Пусть T(<var>n</var>) будет суммой первых <var>n</var> элементов этой последовательности.<br />
Вам дано, что T(1) = 1, T(20) = 86, T(10<sup>3</sup>) = 364089 и T(10<sup>9</sup>) = 498676527978348241.</p>

<p>Найдите T(10<sup>18</sup>). В качестве ответа приведите последние 9 цифр полученного числа.</p>

</div>