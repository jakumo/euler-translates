Subject:
Последовательность зеркальных степеней

Body:
<div class="problem_content">

<p>Для двух целых чисел $n,e &gt; 1$ определим $(n,e)$-<i>ПЗС (последовательность зеркальных степеней)</i> как бесконечную последовательность целых чисел $(a_i)_{i\ge 0}$, такую что для всех $i\ge 0$, $a_{i+1} = min(a_i^e,n-a_i^e)$ и $a_i &gt; 1$.
<br />
Примерами таких последовательностей являются две $(18,2)$-ПЗС последовательности, созданные чередованием чисел $2$ и $4$.</p>

<p>Заметим: несмотря на то, что последовательность уникально определяется $n,e$ и $a_0$, для большинства их значений такой последовательности не существует. Например, не существует $(n,e)$-ПЗС последовательности для $n &lt; 6$.</p>

<p>Определим $C(n)$ как количество $(n,e)$-ПЗС для какого-либо $e$ и $\displaystyle D(N) = \sum_{n=2}^N {C(n)}$.
<br />
Вам дано, что $D(10) = 2$, $D(100) = 21$, $D(1000) = 69$, $D(10^6) = 1303$ и $D(10^{12}) = 1014800$.</p>
 
<p>Найдите $D(10^{18})$.</p>

</div>