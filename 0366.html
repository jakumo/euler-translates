Subject:
Игра в камни 3

Body:
<div class="problem_content">

<p>
Два игрока, Антон и Бернард, играют в следующую игру.
<br />
Есть одна кучка из n камней.
<br />
Первый игрок может убрать из нее любое положительное количество камней, но не всю кучу сразу.
<br />
Далее каждый игрок по очереди убирает не больше удвоенного количества камней, убранных противником в предыдущий ход.
<br />
Побеждает игрок, убравший последний камень.
</p>
<p>
К примеру, n=5.
<br />
Если первый игрок уберет больше, чем один камень, его противник сможет убрать все оставшиеся.
<br />
Если первый игрок уберет один камень, оставив четыре, его противник тоже уберет один, оставив три камня.
<br />
Первый игрок не может убрать все три, потому что он может убрать не более 2
×1
=2 камней. Предположим, он уберет еще один - останется 2. Второй игрок может убрать два оставшихся камня и выиграть.
<br />
Таким образом, 5 - проигрышная позиция для первого игрока
<br />
Для некоторых выигрышных позиций существует больше одного возможного хода первого игрока
<br />
Например, когда n=17, первый игрок может убрать один или четыре камня первым ходом.
</p>
<p>
Пусть M(n) будет максимальным числом камней, которое первый игрок может взять в выигрышной позиции <i>первым ходом</i> и M(n)=0 для любой другой позиции.
</p>
<p>
<span style="font-family:times new roman;font-size:13pt;">∑</span>
M(n) для n
≤
100 равно 728.
</p>
<p>
Найдите  
<span style="font-family:times new roman;font-size:13pt;">∑</span>
M(n) для n
≤
10<sup>18</sup>.
В качестве ответа приведите остаток от деления полученного числа на 10<sup>8</sup>.
</p>
</div>