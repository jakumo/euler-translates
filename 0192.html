Subject:
Наилучшие аппроксимации

Body:
<div class="problem_content">
<p>Пусть <var>x</var> - действительное число.<br />
<i>Наилучшая аппроксимация</i> <var>x</var> для <i>ограниченного знаменателя</i> <var>d</var> - рациональная дробь <var>r</var>/<var>s</var> <i>в сокращенной форме</i>, у которой <var>s</var> ≤ <var>d</var>, такая, что любое рациональное число, которое ближе к <var>x</var>, чем к <var>r</var>/<var>s</var>, имеет знаменатель больше <var>d</var>:</p>

<div style="text-align:center;">|<var>p</var>/<var>q</var>-<var>x</var>| < |<var>r</var>/<var>s</var>-<var>x</var>| ⇒ <var>q</var> > <var>d</var></div>

<p>К примеру, наилучшая аппроксимация √13 для знаменателя, ограниченного значением 20, составляет 18/5. В свою очередь, для знаменателя, ограниченного значением 30, наилучшая аппроксимация √13 равна 101/28.</p>

<p>Найдите сумму всех знаменателей наилучших аппроксимаций √<var>n</var>, при ограничении на знаменатель равном 10<sup>12</sup>, где <var>n</var> не является идеальным квадратом и 1 < <var>n</var> ≤ 100000.</p>
</div>