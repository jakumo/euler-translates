Subject:
Странные рекурсивные отношения

Body:
<div class="problem_content">

<p>
Функция $f$ определена для всех натуральных аргументов следующим образом:
<ul>
<li>$f(1)=1$
<li>$f(3)=3$
<li>$f(2n)=f(n)$
<li>$f(4n + 1)=2f(2n + 1) - f(n)$
<li>$f(4n + 3)=3f(2n + 1) - 2f(n)$
</li>
</ul>
</p>
<p>Функция $S(n)$ определена как $\sum_{i=1}^{n}f(i)$.</p>
<p>$S(8)=22$ и $S(100)=3604$.</p>
<p>Найдите $S(3^{37})$. В качестве ответа приведите последние 9 цифр полученного числа.</p>


</div>