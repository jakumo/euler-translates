Subject:
Игра в числовые последовательности

Body:
<div class="problem_content">

<p>Игра в числовые последовательности начинается с последовательности <var>S</var> из <var>N</var> чисел, записанных в ряд.</p>
<p>Два игрока ходят по очереди. В свой ход каждый игрок должен выбрать или первое, или последнее число в последовательности и убрать его из нее.</p>
<p>Очки игрока равны сумме всех чисел, которые были им убраны. Каждый игрок стремится получить как можно большее количество очков.</p>
</p>Если <var>N</var> = 4 и <var>S</var> = {1, 2, 10, 3}, тогда каждый игрок получает максимальную возможную сумму следующим образом:</p>
<ul>
<li>Игрок 1: убирает первое число (1)</li>
<li>Игрок 2: убирает последнее число из оставшейся последовательности (3)</li>
<li>Игрок 1: убирает последнее число из оставшейся последовательности (10)</li>
<li>Игрок 2: убирает оставшееся число (2)</li>
</ul>
<p>Игрок 1 получает 1 + 10 = 11 очков.</p>
<p>Пусть <var>F</var>(<var>N</var>) будет количеством очков игрока 1, если оба игрока следуют оптимальной стратегии игры для последовательности <var>S</var> = {<var>s</var><sub>1</sub>, <var>s</var><sub>2</sub>,&nbsp;...,&nbsp;<var>s<sub>N</var></sub>}, определенной как:</p>
<ul>
<li><var>s</var><sub>1</sub> = 0</li>
<li><var>s</var><sub><var>i</var>+1</sub> = (<var>s<sub>i</sub></var><sup>2</sup> + 45) modulo 1 000 000 007</li>
</ul>
<p>Последовательность начинается следующим образом: <var>S</var>&nbsp;=&nbsp;{0,&nbsp;45,&nbsp;2070,&nbsp;4284945,&nbsp;753524550,&nbsp;478107844,&nbsp;894218625,&nbsp;...}.</p>
<p>Вам дано, что <var>F</var>(2)&nbsp;=&nbsp;45, <var>F</var>(4)&nbsp;=&nbsp;4284990, <var>F</var>(100)&nbsp;=&nbsp;26365463243, <var>F</var>(10<sup>4</sup>)&nbsp;=&nbsp;2495838522951.</p>
<p>Найдите <var>F</var>(10<sup>8</sup>).</p>

</div>