Subject:
Торпидс

Body:
<div class="problem_content">
<p>
"Торпидс" - это состязания по гребле, ежегодно проводящиеся в Оксфорде. Они следуют любопытным правилам:

<ul><li>
Дивизия состоит из $n$ лодок (обычно 13), расположенных в порядке, соответствующем их прошлым результатам.
</li><li>
Все лодки внутри дивизии начинают гонку вдоль реки с 40-метровыми интервалами в таком порядке, что лодка, занимавшая высшее место, начинает выше всех по течению.
</li><li>
Все лодки одновременно начинают грести вверх по течению, пытаясь нагнать впереди идущую лодку и уйти от лодок позади.
</li><li>
Каждая лодка продолжает грести, пока она <em>или</em> не достигнет финишной линии, <em>или</em> не настигнет ("ударит") впереди идущую лодку.
</li><li>
Финишная линия находится на расстоянии $L$ метров (в реальности - около 1800 метров) вверх по течению, начиная от стартовой позиции лодки, занимавшей низшее место. (Из-за ступенчатого расположения стартовых позиций лодки, занимавшие высшие места, должны пройти меньшую дистанцию, чем лодки, занимавшие низшие места.)
</li><li>
После "удара" "ударившая" лодка выходит из гонки. "Ударенная" лодка должна продолжать гонку и даже может быть снова "ударена" лодкой, начавшей на две или более позиции позади нее.
</li><li>
После гонки лодкам присваиваются новые места внутри дивизии, основываясь на произошедших "ударах". А именно: для любой лодки $A$, начавшей на низшем месте, чем лодка $B$, лодка $A$ получит место выше, чем $B$, в новом порядке после гонки тогда и только тогда, если произошло одно из следующих:
  <ol><li> $A$ "ударила" непосредственно $B$ </li>
  <li> $A$ "ударила" другую лодку, которая после этого "ударила" $B$ </li>
  <li> $A$ "ударила" другую лодку, которая "ударила" другую лодку, которая "ударила" $B$ </li>
  <li> и т. д. </li></ol></li></ul>
<b>ПРИМЕЧАНИЕ</b>: В рамках этой задачи можно пренебречь длиной лодки и предположить, что "удар" происходит исключительно тогда, когда обе лодки полностью поравнялись. (В реальности "удар" засчитывается, как только происходит физический контакт, что обычно происходит до того, как обе лодки поравняются.)
</p>
<p>
Положим, что в этой гонке каждая лодка $B_j$ гребет с постоянной скоростью $v_j = -$log$X_j$ метров в секунду, где $X_j$ выбираются случайно (с равномерным распределением) между 0 и 1 и независимы друг от друга. Это - скорости относительно берега реки, вы можете пренебречь течением реки.
</p>
<p>
Пусть $p(n,L)$ будет вероятностью того, что новый порядок в дивизии будет <b>четной перестановкой</b> исходного порядка, если в дивизии $n$ лодок и длина заплыва $L$ метров.
</p>
<p>
Например, при $n=3$ и $L=160$, с лодками $A$,$B$,$C$ в таком исходном порядке ($C$ на высшем месте), возможны следующие результаты гонки:
</p>
<table cellspacing="15" align="center"><tr><th> Случившиеся "удары" </th>
  <th> Новый порядок </th>
  <th> Перестановка </th>
  <th> Вероятность </th>
 </tr><tr align="center"><td> нет </td>
  <td> $A$, $B$, $C$ </td>
  <td> четная </td>
  <td> $4/15$ </td>
 </tr><tr align="center"><td> $B$ "ударила" $C$ </td>
  <td> $A$, $C$, $B$ </td>
  <td> нечетная </td>
  <td> $8/45$ </td>
 </tr><tr align="center"><td> $A$ "ударила" $B$ </td>
  <td> $B$, $A$, $C$ </td>
  <td> нечетная </td>
  <td> $1/3$ </td>
 </tr><tr align="center"><td>     $B$ "ударила" $C$, потом $A$ "ударила" $C$     </td>
  <td> $C$, $A$, $B$ </td>
  <td> четная </td>
  <td> $4/27$ </td>
 </tr><tr align="center"><td>     $A$ "ударила" $B$, потом $B$ "ударила" $C$     </td>
  <td> $C$, $B$, $A$ </td>
  <td> нечетная </td>
  <td> $2/27$ </td>
 </tr></table><p>
Посему, $p(3,160) = 4/15 + 4/27 = 56/135$.
</p>
<p>
Вам также дано, что $p(4,400)=0.5107843137$, округленное до 10 цифр после десятичной точки.
</p>
<p>
Найдите $p(13,1800)$, округленное до 10 цифр после десятичной точки.
</p>

</div>