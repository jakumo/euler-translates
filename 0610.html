Subject:
Римские цифры II

Body:
<div class="problem_content">

<p>Случайный генератор выдает последовательность символов, выбранных из множества {<span style="font-family:'courier new', monospace;">I</span>, <span style="font-family:'courier new', monospace;">V</span>, <span style="font-family:'courier new', monospace;">X</span>, <span style="font-family:'courier new', monospace;">L</span>, <span style="font-family:'courier new', monospace;">C</span>, <span style="font-family:'courier new', monospace;">D</span>, <span style="font-family:'courier new', monospace;">M</span>, <span style="font-family:'courier new', monospace;">#</span>}. Каждый элемент последовательности определяется путем случайного выбора одного из этих символов независимо от других элементов последовательности. В каждом шаге все семь букв имеют одинаковую вероятность быть выбранными, равную 14%, но символ <span style="font-family:'courier new', monospace;">#</span> имеет вероятность выбора всего лишь 2%.</p>

<p>Мы записываем последовательность букв слева направо в том порядке, в каком они сгенерированы, и останавливаемся при первом появлении символа <span style="font-family:'courier new', monospace;">#</span> (его сам при этом не записывая). Однако, мы оговариваем, что записанное нами должно всегда (когда непустое) являться корректной записью числа римскими цифрами в минимальной форме. Если добавление следующей буквы противоречит этому, мы ее пропускаем и пробуем снова со следующим сгенерированным символом.</p>

<p>Пожалуйста, внимательно прочитайте <a href="/roman.html">"О римских цифрах"</a>, чтобы узнать конкретные правила, определяющие "корректную запись числа римскими цифрами" и "минимальную форму". Например, последовательность (единственная), представляющая число 49 - это <span style="font-family:'courier new', monospace;">XLIX</span>. Субтрактивная комбинация <span style="font-family:'courier new', monospace;">IL</span> некорректна из-за правила (ii), а комбинация <span style="font-family:'courier new', monospace;">XXXXIX</span> - корректна, но не минимальна. Правила никак не ограничивают количество появлений символа <span style="font-family:'courier new', monospace;">M</span>, поэтому все целые числа имеют корректное представление. Эти правила также использовались в <a href="https://euler.jakumo.org/problems/view/89.html">Задаче 89</a>, и мы предлагаем вам сначала решить ее.</p>

<p>Найдите ожидаемое значение числа, представленного тем, что мы записали до остановки (если ничего не было записано, то считайте это число за ноль). Дайте ваш ответ округленным до 8 знака после десятичной точки.</p>


</div>
