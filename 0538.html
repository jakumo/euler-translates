Subject:
Наибольшие четырехугольники

Body:
<div class="problem_content">

<p>Рассмотрим последовательность <var>S</var> = (<var>s</var><sub>1</sub>, <var>s</var><sub>2</sub>, ..., <var>s<sub>n</sub></var>).</p>

<p>Пусть f(<var>S</var>) будет периметром четырехугольника с наибольшей площадью, чьи длины сторон (<var>s<sub>i</sub></var>, <var>s<sub>j</sub></var>, <var>s<sub>k</sub></var>, <var>s<sub>l</sub></var>) являются четырьмя элементами последовательности <var>S</var> (числа <var>i</var>, <var>j</var>, <var>k</var>, <var>l</var> различны между собой). Если существует несколько четырехугольников с одинаковой максимальной площадью, из них выбирается четырехугольник с наибольшим периметром.</p>

<p>Например, если <var>S</var> = (8, 9, 14, 9, 27), мы можем взять элементы (9, 14, 9, 27) и образовать <dfn title="Равнобедренная трапеция - четырехугольник, у которого одна пара противолежащих сторон параллельна и разной длины, а другая пара не параллельна и имеет одинаковую длину."><b>равнобедренную трапецию</b></dfn> с параллельными сторонами длиной 14 и 27 и боковыми сторонами длиной 9. Площадь этого четрыехугольника равна 127.611470879... Можно показать, что это - наибольшая площадь среди всех возможных четырехугольников с длинами сторон, являющимися элементами <var>S</var>. Посему, f(<var>S</var>) = 9 + 14 + 9 + 27 = 59.</p>

<p>Пусть <var>u<sub>n</sub></var> = 2<sup>B(3<var>n</var>)</sup> + 3<sup>B(2<var>n</var>)</sup> + B(<var>n</var>+1), где B(<var>k</var>) - количество битов "1" в числе <var>k</var>, представленном в основании 2.<br />
Например, B(6) = 2, B(10) = 2 и B(15) = 4, и <var>u</var><sub>5</sub> = 2<sup>4</sup> + 3<sup>2</sup> + 2 = 27.</p>

<p>Также, пусть <var>U<sub>n</sub></var> будет последовательностью (<var>u</var><sub>1</sub>, <var>u</var><sub>2</sub>, ..., <var>u<sub>n</sub></var>).<br />
Например, <var>U</var><sub>10</sub> = (8, 9, 14, 9, 27, 16, 36, 9, 27, 28).</p>

<p>Можно показать, что f(<var>U</var><sub>5</sub>) = 59, f(<var>U</var><sub>10</sub>) = 118, f(<var>U</var><sub>150</sub>) = 3223.<br />
Также можно показать, что Σ f(<var>U<sub>n</sub></var>) = 234761 для 4 ≤ n ≤ 150.<br />
Найдите Σ f(<var>U<sub>n</sub></var>) для 4 ≤ n ≤ 3 000 000.</p>


</div>