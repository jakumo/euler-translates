Subject:
Прыгающая блоха

Body:
<div class="problem_content">

<p>Стол в форме правильного шестиугольника с длиной стороны $N$ разделен на равносторонние треугольники с длиной стороны $1$. На изображении ниже показан случай с $N = 3$.</p>

<div style="text-align:center;">
<img src="https://projecteuler.net/project/images/p702_jumping_flea.png" alt="hexagonal table" />
</div>

<p>Блоха пренебрежительно малого размера прыгает по столу. Блоха начинает путь в центре стола. Далее, с каждым шагом она выбирает один из шести углов стола и перепрыгивает на среднюю точку между своим текущим расположением и выбранным углом.</p>

<p>Для каждого треугольника $T$ обозначим минимальное количество прыжков, необходимое блохе, чтобы попасть внутрь треугольника $T$, как $J(T)$. Приземление на сторону или вершину треугольник $T$ не засчитывается.</p>

<p>Например, для обозначенного звездочкой на изображении треугольника $J(T) = 3$: прыжок на половину пути от центра до F, затем к C, затем к E.</p>

<p>Пусть $S(N)$ будет суммой $J(T)$ для всех треугольников $T$, расположенных на верхней половине стола и направленных вершиной вверх. Такие треугольники для случая $N = 3$ закрашены черным на изображении выше.</p>

<p>Известно, что $S(3) = 42$, $S(5) = 126$, $S(123) = 167178$ и $S(12345) = 3185041956$.</p>

<p>Найдите $S(123456789)$.</p>