Subject:
Пересекающиеся прямые

Body:
<div class="problem_content">

<p>
При данном множестве уникальных прямых $L$, пусть $M(L)$ будет количеством прямых в этом множестве, и пусть $S(L)$ будет суммой количеств пересечений с другими прямыми множества для каждой прямой. Например, два множества из трех прямых показаны ниже:
</p>
<div align="center"><img src="https://projecteuler.net/project/images/p630_threelines.png" alt="crossed lines" /></div>
<p>
В обоих случаях M(L) равно 3 и S(L) равно 6: каждая из трех прямых пересекается с двумя другими прямыми. Заметим, что даже если прямые пересекаются в одной точке, для каждой прямой это пересечение считается отдельно.
</p>
<p>
Рассмотрим точки ($T_{2k−1}$, $T_{2k}$) для целого $k &gt;= 1$, сгенерированные следующим образом:
</p>
<p>
$S_0 	=  	290797$<br /> 
$S_{n+1} 	=  	{S_n}^2 \:\: \rm{mod} \:\: 50515093$<br />
$T_n 	=  	( S_n \:\: \rm{mod} \:\: 2000 ) − 1000$
</p>
<p>
Например, первыми тремя точками являются: (527, 144), (−488, 732), (−454, −947). При данных первых $n$ таким образом сгенерированных точках, пусть $L_n$ будет множеством <b>уникальных</b> прямых, образованных соединением каждой точки с каждой другой точкой и продлением полученных отрезков на бесконечное расстояние в обоих направлениях. Можем определить $M(L_n)$ и $S(L_n)$, как описано выше.
</p>
<p>
Например, $M(L_3) = 3$ и $S(L_3) = 6$. Также, $M(L_{100}) = 4948$ и $S(L_{100}) = 24477690$.
</p><p>
Найдите $S(L_{2500})$.
</p>

</div>