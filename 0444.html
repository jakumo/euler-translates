Subject:
Лотерея круглого стола

Body:
<div class="problem_content">

<p>Группа из <var>p</var> людей решила сесть за круглый стол и разыграть игру с обменом лотерейными билетами. Каждый игрок начинает со случайно назначенным нестертым лотерейным билетом. При стирании защитного покрытия на каждом билете становится виден его выигрыш - целое количество фунтов стерлингов между &pound;1 и &pound;<var>p</var>, причем все билеты имеют разный выигрыш. Цель игры для каждого игрока - получить как можно больший выигрыш на момент покидания игры.</p>

<p>Случайный человек выбирается первым игроком. Далее игроки ходят по кругу, каждый игрок в свой ход может выбрать одно из двух:</p>

<p>1. Игрок стирает покрытие на своем билете и показывает его выигрыш всем сидящим за столом.<br />
2. Игрок может обменять свой нестертый билет на стертый билет предыдущего игрока и покинуть игру с этим билетом. Предыдущий игрок тогда стирает покрытие с полученного билета и показывает его выигрыш всем сидящим за столом.</p>

<p>Игра завершается, когда все билеты стерты. Все игроки, остающиеся за столом, должны покинуть игру с имеющимся на руках билетом.</p>

<p>Предположим, что каждый игрок следует оптимальной стратегии для максимизирования ожидаемого выигрыша его билета. </p>

<p>Пусть E(<var>p</var>) будет ожидаемым числом игроков, остающихся за столом на момент завершения игры, при общем количестве игроков равным <var>p</var> (например, E(111)&nbsp;=&nbsp;5.2912 при округлении до 5 значимых цифр).</p>

<p>Пусть S<sub>1</sub>(<var>N</var>) = <img style="vertical-align:middle" src="project/http://projecteuler.net/images/p444_sum.png" /> E(<var>p</var>)<br />
Пусть S<sub><var>k</var></sub>(<var>N</var>) = <img style="vertical-align:middle" src="project/http://projecteuler.net/images/p444_sum.png" /> S<sub><var>k</var>-1</sub>(<var>p</var>) для <var>k</var> > 1</p>

<p>Найдите S<sub>20</sub>(10<sup>14</sup>) и запишите ответ в стандартном виде округленным до 10 значимых цифр. Используйте строчную латинскую букву "e", чтобы отделить мантиссу от порядка (например, S<sub>3</sub>(100) = 5.983679014e5).</p>

</div>