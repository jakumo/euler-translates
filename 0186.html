Subject:
Связанность сети

Body:
<div class="problem_content">
<p>Вот несколько записей загруженной телефонной системы с миллионом пользователей:</p>
<div style='text-align:center;'>
<table cellspacing='0' cellpadding='2' border='1' align='center'>
<tr style='background-color:#c1daf9;'>
<td>№</td><td width='60' align='center'>Caller</td><td width='60' align='center'>Called</td></tr>
<tr><td align='center'>1</td><td align='center'>200007</td><td align='center'>100053</td></tr>
<tr><td align='center'>2</td><td align='center'>600183</td><td align='center'>500439</td></tr>
<tr><td align='center'>3</td><td align='center'>600863</td><td align='center'>701497</td></tr>
<tr><td align='center'>...</td><td align='center'>...</td><td align='center'>...</td></tr>
</table>
</div>
<p>В строке № n телефонный номер звонящего и вызываемый номер являются Caller(n) = S<sub>2n-1</sub> и Called(n) = S<sub>2n</sub> соответственно, где S<sub>1,2,3,...</sub> образуются "Генератором Фибоначчи с задержкой":</p>

<p>При 1 ≤ k ≤ 55, S<sub>k</sub> = [100003 - 200003k + 300007k<sup>3</sup>] (modulo 1000000)<br />
При 56 ≤ k, S<sub>k</sub> = [S<sub>k-24</sub> + S<sub>k-55</sub>] (modulo 1000000)</p>

<p>Если Caller(n) = Called(n), то предполагается, что пользователь ошибся в наборе номера, и вызов не происходит. В противном случае вызов происходит успешно.</p>

<p>Оговорим, что начиная с первой строки, любая пара пользователей X и Y - друзья, если X звонит Y или наоборот. Аналогично, X будет другом друга Z, если X является другом Y, который, в свою очередь является другом Z; и так далее, с образованием более длинных цепочек.</p>

<p>Номер премьер-министра 524287. После скольких удачных звонков, не считая неправильный набор, 99% пользователей (включая самого премьер-министра), окажутся друзьями премьер-министра, друзьями его друзей и т.д.?</p>
</div>