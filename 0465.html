Subject:
Полярные многоугольники

Body:
<div class="problem_content">

<p><i>Ядро</i> многоугольника определено как множество точек, из которых обозрима вся граница многоугольника. Мы определим <i>полярный многоугольник</i> как многоугольник, для которого начало координат <u>строго</u> содержится в его ядре.</p>

<p>В рамках этой задачи многоугольник может иметь коллинеарные последовательные вершины. Однако, многоугольник по-прежнему не  может самопересекаться или иметь нулевую площадь.</p>

<p>Например, только первый из следующих многоугольников является полярным (ядра второго, третьего и четвертого не содержат строго начало координат, а пятый вообще не имеет ядра):
<p align='center'><img src='http://projecteuler.net/project/images/p465_polygons.png'></p></p>


<p>Обратите внимание, что первый многоугольник имеет три последовательные коллинеарные вершины.</p>

<p>Пусть P(<var>n</var>) будет количеством полярных многоугольников, таких что их вершины (<var>x</var>, <var>y</var>) имеют целочисленные координаты, чьи абсолютные значения не превышают <var>n</var>.</p>

<p>Заметим, что многоугольники считаются разными, если они имеют различное множество сторон, даже если они заключают одинаковую площадь. Например, многоугольник со вершинами [(0,0),(0,3),(1,1),(3,0)] отличается от многоугольника со вершинами [(0,0),(0,3),(1,1),(3,0),(1,0)].</p>

<p>Для примера, P(1) = 131, P(2) = 1648531, P(3) = 1099461296175 и P(343) mod 1&nbsp;000&nbsp;000&nbsp;007 = 937293740.</p>

<p>Найдите P(7<sup>13</sup>) mod 1&nbsp;000&nbsp;000&nbsp;007.</p>


</div>