Subject:
Графы решеток

Body:
<div class="problem_content">

<p>
Рассмотрим ориентированный граф, построенный на ортогональной решетке с $H\times W$ вершинами. Ребрами графа являются горизонтальные и вертикальные отрезки, соединяющие соседние вершины. Далее, проводятся $W$ вертикальных направленных линий и все ребра на этих линиях наследуют их направление. Таким же образом проводятся $H$ горизонтальных направленных линий, и все ребра на этих линиях наследуют их направление.
</p>
<p>
Две вершины ориентированного графа $A$ и $B$ являются <b>сильно соединенными</b>, если одновременно существуют следующие два пути вдоль направленных ребер: из $A$ в $B$ и из $B$ в $A$. Заметим, что каждая вершина сильно соединена сама с собой.
</p>
<p>
<b>Сильно соединенным компонентом</b> в ориентированном графе называется непустое множество $M$, содержащее вершины, удовлетворяющие следующим двум условиям:
</p>
<ul>
<li>Все вершины во множестве $M$ сильно соединены друг с другом.</li>
<li>$M$ максимально, иными словами, ни одна вершина в $M$ не соединена сильно ни с одной вершиной вне $M$.</li>
</ul>
<p>
Существует $2^H\times 2^W$ способов провести направленные линии. Каждый способ дает ориентированный граф $\mathcal{G}$. Определим $S(\mathcal{G})$ как количество сильно соединенных компонентов $\mathcal{G}$.
</p>
<p>
Изображение ниже показывает ориентированный граф с $H=3$ и $W=4$, состоящий из четырех различных сильно соединенных компонентов (обозначенных разными цветами).
</p>
<div style="text-align:center;">
<img src="https://projecteuler.net/project/images/p716_gridgraphics.jpg" class="dark_img" alt="" /></div>
<p>
Определим $C(H,W)$ как сумму $S(\mathcal{G})$ для всех возможных графов на решетке $H\times W$. Известно, что $C(3,3) = 408$, $C(3,6) = 4696$ и $C(10,20) \equiv 988971143 \pmod{1\,000\,000\,007}$.
</p>
<p>
Найдите $C(10\,000,20\,000)$. В качестве ответа приведите остаток от деления полученного результата на $1\,000\,000\,007$.
</p>
</div>