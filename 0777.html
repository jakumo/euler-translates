Subject:
Кривые Лиссажу

Body:
<div class="problem_content">

<p>Для взаимно простых положительных целых чисел $a$ и $b$ пусть $C_{a,b}$ будет кривой, определенной как:
\[
\begin{align}
x &amp;= \cos \left(at\right) \\
y &amp;= \cos \left(b\left(t-\frac{\pi}{10}\right)\right)
\end{align}
\]
где $t$ варьируется в пределах от 0 до $2\pi$.</p>

<p>Например, изображения ниже показывают $C_{2,5}$ (слева) и $C_{7,4}$ (справа):</p>
<div style="text-align:center;">
<img src="https://projecteuler.net/project/images/p777_lissajous-pair-25-74.png" class="dark_img" alt="" height="300" />
</div>
<p>Определим $d(a,b) = \sum (x^2 + y^2)$, где сумма взята по всем точкам (x, y), в которых $C_{a,b}$ пересекает саму себя.</p>

<p>Например, в показанном выше случае с $C_{2,5}$ кривая пересекает саму себя в двух точках: (0.31, 0) и (-0.81, 0) с округленными до двух десятичных знаков координатами, что дает $d(2, 5)=0.75$. Известно, что $d(2,3)=4.5$, $d(7,4)=39.5$, <span style="white-space:nowrap;">$d(7,5)=52$,</span> и $d(10,7)=23.25$.</p>

<p>Пусть $s(m) = \sum d(a,b)$, где сумма взята по всем парам взаимно простых целых чисел $a,b$ для $2\le a\le m$ и $2\le b\le m$.<br />
Известно, что $s(10) = 1602.5$ и $s(100) = 24256505$.</p>

<p>Найдите $s(10^6)$. Запишите свой ответ в стандартном виде, округленный до 12 значимых цифр после десятичной точки. Используйте латинскую строчную букву "e", чтобы отделить мантиссу от порядка. Например, $s(100)$ было бы записано как 2.425650500e7.</p>

</div>