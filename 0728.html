Subject:
Круг из монет

Body:
<div class="problem_content">

<p>Рассмотрим $n$ монет, расположенных в круг, где каждая монета повернута орлом или решкой. Один ход заключается в переворачивании $k$ последовательно расположенных монет: орел-решка или решка-орел. Задача - используя последовательность ходов, перевернуть все монеты решкой вверх.</p>

<p>Расммотрим пример, показанный ниже, где $n=8$ и $k=3$ и в начальном расположении одна монета повернута решкой (черная). В примере показано решение для такого начального расположения.</p>

<div class="center">
<img src="https://projecteuler.net/project/images/p728_coin_circle.jpg" class="dark_img" alt="" style="width:100%;" /></div>

<p>Не все начальные расположения имеют решение для данных значений $n$ и $k$. Пусть $F(n,k)$ будет количеством начальных расположений, которые имеют решение. Известно, что $F(3,2) = 4$, $F(8,3) = 256$ и $F(9,3) = 128$.</p>

<p>Далее определим:</p>
<div class="center">
$\displaystyle	S(N) = \sum_{n=1}^N\sum_{k=1}^n F(n,k)$</div>

<p>Также известно, что $S(3) = 22$, $S(10) = 10444$ и $S(10^3) \equiv 853837042 \pmod{1\,000\,000\,007}$</p>

<p>Найдите $S(10^7)$. В качестве ответа приведите остаток от деления полученного результата на $1\,000\,000\,007$</p>

</div>

  