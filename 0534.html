Subject:
Слабые ферзи

Body:
<div class="problem_content">

<p>Классическая <b>задача о восьми ферзях</b> - хорошо известная головоломка о расположении восьми шахматных ферзей на шахматной доске 8×8 так, чтобы никакие два ферзя не угрожали друг другу. Если считать повороты и отражения одного и того же расположения фигур различными расположениями, можно найти всего 92 возможных различных расположения для восьми ферзей. В общем случае стоит вопрос о количестве возможных различных расположений <var>n</var> ферзей на доске <var>n</var>×<var>n</var>. Например, существует 2 различных расположения для <var>n</var>=4.</p>

<p>Определим <i>слабого ферзя</i> на доске <var>n</var>×<var>n</var> как фигуру, которая может двигаться на любое количество клеток по горизонтали, но максимум - на <var>n</var>−1−<var>w</var> клеток по верикали или диагонали, где 0≤w&lt;n - "фактор слабости". Например, слабый ферзь на доске <var>n</var>×<var>n</var> с фактором слабости <var>w</var>=1, расположенный в нижнем ряду, не сможет угрожать ни одной клетке верхнего ряда, так как слабому ферзю понадобилось бы переместиться на <var>n</var>−1 клеток по вертикали или диагонали, чтобы туда добраться, но он может двигаться только на <var>n</var>−2 клеток в этих направлениях. В то же время, слабый ферзь не ограничен в движении по горизонтали, и, таким образом, угрожает каждой клетке своего ряда, независимо от его положения в этом ряду.</p>

<p>Пусть Q(<var>n</var>,<var>w</var>) будет количеством способов расположения <var>n</var> слабых ферзей с фактором слабости <var>w</var> на доске <var>n</var>×<var>n</var> так, чтобы никакие два ферзя не угрожали друг другу. Можно показать, например, что Q(4,0)=2, Q(4,2)=16 и Q(4,3)=256.</p>

<p>Пусть $S(n)=\displaystyle\sum_{w=0}^{n-1} Q(n,w)$.</p>

<p>Известно, что S(4)=276 и S(5)=3347.</p>

<p>Найдите S(14).</p>

</div>