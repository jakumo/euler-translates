Subject:
Перестановки 3-гладких чисел

Body:
<div class="problem_content">

<p>
A <b>3-гладкое число</b>  - это целое число, которое не имеет ни одного простого делителя больше трех. Для целого <var>N</var>, определим S(<var>N</var>) как множество 3-гладких чисел меньше или равных <var>N</var> . Например, S(20) = { 1, 2, 3, 4, 6, 8, 9, 12, 16, 18 }.
</p>
<p>
Определим F(<var>N</var>) как количество перестановок S(<var>N</var>), в которых каждый элемент следует после всех своих собственных делителей.
</p>
<p>
Вот одна из возможных перестановок для <var>N</var> = 20.<br>
- 1, 2, 4, 3, 9, 8, 16, 6, 18, 12.<br>
А следующая перестановка не подходит под условия задачи, так как 12 стоит перед его делителем 6.<br>
- 1, 2, 4, 3, 9, 8, <b>12</b>, 16, <b>6</b>, 18.
</p>
<p>
Можно показать, что F(6) = 5, F(8) = 9, F(20) = 450 и F(1000) <img src='http://projecteuler.net/images/symbol_asymp.gif' width='11' height='9' alt='&asymp;' border='0' style='vertical-align:middle;' /> 8.8521816557e21.<br>
Найдите F(10<sup>18</sup>). Дайте ответ в стандартном виде, округленным до десяти знаков после десятичной точки.<br>
При указания ответа используйте латинскую строчную букву "e" для отделения мантиссы от порядка. Например, если ответ равен 112 233 445 566 778 899, тогда он будет выглядеть как 1.1223344557e17.
</p>

</div>