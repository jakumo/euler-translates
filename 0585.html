Subject:
Вложенные квадратные корни

Body:
<div class="problem_content">

<p>Рассмотрим выражение $\small \sqrt{x+\sqrt{y}+\sqrt{z}}$, которое представляет собой <b>вложенный квадратный корень</b>. $x$, $y$ и $z$ - натуральные числа, а $y$ и $z$ не могут быть полными квадратами, так что число под внешним квадратным корнем иррационально. Тем не менее, можно показать, что для некоторых комбинаций $x$, $y$ и $z$ данное выражение может быть упрощено до вида суммы и/или разницы квадратных корней целых чисел, таки образом <b>разложив</b> квадратные корни в изначальном выражении. </p>

<p>Вот несколько примеров такого разложения:<br />
$\small \sqrt{3+\sqrt{2}+\sqrt{2}}=\sqrt{2}+\sqrt{1}=\sqrt{2}+1$<br />
$\small \sqrt{8+\sqrt{15}+\sqrt{15}}=\sqrt{5}+\sqrt{3}$<br />
$\small \sqrt{20+\sqrt{96}+\sqrt{12}}=\sqrt{9}+\sqrt{6}+\sqrt{3}-\sqrt{2}=3+\sqrt{6}+\sqrt{3}-\sqrt{2}$<br />
$\small \sqrt{28+\sqrt{160}+\sqrt{108}}=\sqrt{15}+\sqrt{6}+\sqrt{5}-\sqrt{2}$</p>
<p>Как видите, целые числа, использованные в разложенном выражении, могут также быть полными квадратами, что позволяет далее упростить выражение.</p>

<p>Пусть F($n$) будет количеством различных выражений $\small \sqrt{x+\sqrt{y}+\sqrt{z}}$, которые могут быть разложены в сумму и/или разность конечного количества квадратных корней с дополнительным условием, что $0&lt;x \le n$. То есть,<br />
$\small \displaystyle \sqrt{x+\sqrt{y}+\sqrt{z}}=\sum_{i=1}^k s_i\sqrt{a_i}$,<br />
где $k$, $x$, $y$, $z$ и все $a_i$ - натуральные числа, все $s_i =\pm 1$ и $x\le n$.<br /> Более того, $y$ и $z$ не могут быть полными квадратами.</p>

<p>Вложенные квадратные корни, имеющие одинаковые значения, не считаются различными. Например, все три корня $\small \sqrt{7+\sqrt{3}+\sqrt{27}}$, $\small \sqrt{7+\sqrt{12}+\sqrt{12}}$ и $\small \sqrt{7+\sqrt{27}+\sqrt{3}}$ могут быть разложены в $\small 2+\sqrt{3}$, и поэтому считаются как один квадратный корень.</p>

<p>Известно, что F(10)=17, F(15)=46, F(20)=86, F(30)=213, F(100)=2918 и F(5000)=11134074.<br />
Найдите F(5000000).</p>

</div>