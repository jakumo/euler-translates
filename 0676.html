Subject:
Совпадающие суммы цифр

Body:
<div class="problem_content">

<p>
Пусть $d(i,b)$ будет <b>суммой цифр</b> числа $i$ в системе счисления с основанием $b$. Например, $d(9,2)=2$, так как $9=1001_2$.
При использовании систем счисления с разными основаниями чаще всего соответствующие суммы цифр будут различаться между собой. Например, $d(9,4)=3 \ne d(9,2)$.
</p>

<p>
Однако, для некоторых чисел $i$ будут и совпадения, вроде $d(17,4)=d(17,2)=2$.
Пусть $ M(n,b_1,b_2)$ будет суммой всех натуральных чисел $i \le n$, для которых $d(i,b_1)=d(i,b_2)$.
Например, $M(10,8,2)=18$, $M(100,8,2)=292$ и $M(10^6,8,2)=19173952$.
</p>

<p>
Найдите $\displaystyle \sum_{k=3}^6 \sum_{l=1}^{k-2}M(10^{16},2^k,2^l)$ и приведите в качестве ответа последние 16 цифр полученного числа.
</p>