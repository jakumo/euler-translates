Subject:
Последовательность MEX

Body:
<div class="problem_content">


<p>
В рамках этой задачи $\oplus$ используется для обозначение побитного <strong>исключающего ИЛИ</strong> от двух чисел.<br />
Начав с пустого листа бумаги, будем повторять следующие шаги:</p>

<ol type="1">
<li>Записать наименьшее положительное целое число $a$, которое еще не записано на бумаге;</li>

<li>Найти наименьшее положительное целое число $b$, такое что ни $b$, ни $(a \oplus b)$ в данный момент еще не записаны на бумаге. Затем записать $b$ и <span style="white-space:nowrap;">$(a \oplus b)$.</span></li>
</ol>

<p>
После первой итерации на бумаге будет записано $\{1,2,3\}$. Во второй итерации $a=4$ и, так как <span style="white-space:nowrap;">$(4 \oplus 5)$,</span> $(4 \oplus 6)$ и $(4 \oplus 7)$ все уже записаны, $b$ должно быть равно <span style="white-space:nowrap;">$8$.</span></p>

<p>
После $n$ итераций на бумаге будут записаны $3n$ чисел. Обозначим их сумму как <span style="white-space:nowrap;">$M(n)$.</span><br />
Например, $M(10) = 642$ и <span style="white-space:nowrap;">$M(1000) = 5432148$.</span></p>

<p>
Найдите <span style="white-space:nowrap;">$M(10^{18})$.</span> В качестве ответа приведите остаток от деления полученного результата на <span style="white-space:nowrap;">$1\,000\,000\,007$.</span></p>

</div>