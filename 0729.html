Subject:
Диапазон периодической последовательности

Body:
<div class="problem_content">

<p>Рассмотрим последовательность вещественных чисел $a_n$, заданную начальным значением $a_0$ и рекурсией 
$\displaystyle a_{n+1}=a_n-\frac 1 {a_n}$ для любого $n  \ge 0$.</p>
<p>
Для некоторых начальных значений $a_0$ последовательность будет периодической. Например, $a_0=\sqrt{\frac 1 2}$ дает последовательность:
$\sqrt{\frac 1 2},-\sqrt{\frac 1 2},\sqrt{\frac 1 2}, \dots$</p>
<p>
Нас инересует диапазон такой периодической последовательности, равный разности между максимумом и минимумом последовательности. Например, диапазон приведенной выше последовательности будет равен $\sqrt{\frac 1 2}-(-\sqrt{\frac 1 2})=\sqrt{ 2}$.</p>
<p>
Пусть $S(P)$ будет суммой диапазонов всех таких периодических последовательностей с периодом не больше $P$.<br />
Например, $S(2)=2\sqrt{2} \approx 2.8284$, что равно сумме диапазонов двух последовательностей, начинающихся с $a_0=\sqrt{\frac 1 2}$ и $a_0=-\sqrt{\frac 1 2}$. <br />
Известно, что $S(3) \approx 14.6461$ и $S(5) \approx 124.1056$.
</p><p>
Найдите $S(25)$, округленное до 4 знаков после десятичной точки.</p>