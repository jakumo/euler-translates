Subject:
Сложение по модулю

Body:
<div class="problem_content">
<p>
Пусть <var>a<sub>n</sub></var> - последовательность, заданная в рекурсивном виде: <img src="http://projecteuler.net/project/images/p_326_formula1.gif" alt="" style="vertical-align:middle;"/>.
</p>
<p>
Первые 10 элементов <var>a<sub>n</sub></var> таковы: 1,1,0,3,0,3,5,4,1,9.
</p>
<p>Обозначим через <var>f</var>(<var>N,M</var>) число пар (<var>p,q</var>), удовлетворяющих требованиям: <img src="http://projecteuler.net/project/images/p_326_formula2.gif" alt="" />
</p>
<p>
Нетрудно убедиться, что <var>f</var>(10,10)=4, и эти пары - (3,3), (5,5), (7,9) и (9,10).
</p>
<p>
Помимо этого, известно, что <var>f</var>(10<sup>4</sup>,10<sup>3</sup>)=97158.</p>
<p>
Найдите <var>f</var>(10<sup>12</sup>,10<sup>6</sup>).
</p>
</div>