Subject:
Ограниченные перестановки

Body:
<div class="problem_content">

<p>Пусть $(p_1 p_2 \ldots p_k)$ обозначает перестановку множества ${1, ..., k}$, которая отображается в $p_i\mapsto i$. Определим длину перестановки как $k$. Заметим, что пустая перестановка $()$ имеет нулевую длину.</p>

<p>Определим <i>возникновение</i> перестановки $p=(p_1 p_2 \ldots p_k)$ в перестановке $P=(P_1 P_2 \ldots P_n)$ как последовательность $1\leq t_1 &lt; t_2 &lt; \cdots &lt; t_k \leq n$, такую что $p_i &lt; p_j$ тогда и только тогда, если $P_{t_i} &lt; P_{t_j}$ для всех $i,j \in \{1, ..., k\}$.</p>

<p>Например, $(1243)$ возникает дважды в перестановке $(314625)$: однажды как 1-ый, 3-ий, 4-ый и 6-ой элементы $(3\,\,46\,\,5)$ и однажды как 2-ой, 3-ий, 4-ый и 6-ой элементы $(\,\,146\,\,5)$.</p>

<p>Пусть $f(n, m)$ будет количеством перестановок $P$ длиной не больше $n$, таких что в $P$ нет возникновений перестановки $1243$ и в $P$ есть не больше $m$ возникновений перестановки $21$.</p>

<p>Например, $f(2,0) = 3$ с перестановками $()$, $(1)$, $(1,2)$, но не $(2,1)$.</p>

<p>Вам также дано, что $f(4, 5) = 32$ и $f(10, 25) = 294\,400$.</p>

<p>Найдите остаток от деления $f(10^{18}, 40)$ на $1\,000\,000\,007$.</p>

</div>