Subject:
Семейства префиксов Коллатца

Body:
<div class="problem_content">

<p>
Последовательность Коллатца определяется как:
$a_{i+1} = \left\{  \large{\frac {a_i} 2 \atop 3 a_i+1} {\text{если }a_i\text{ четно} \atop \text{если }a_i\text{ нечетно}} \right.$.
</p>
<p>
Гипотеза Коллатца состоит в том, что, начиная с любого положительного целого числа, эта последовательность рано или поздно достигнет цикла 1,4,2,1....<br />
Определим префикс <var>p(n)</var> для последовательности Коллатца, начинающейся с <var>a<sub>1</sub> = n</var>, как под-последовательность всех чисел, не являющихся степенями двойки (в данной задаче 2<sup>0</sup>=1 считается степенью 2). Например:<br />
<var>p</var>(13) = {13, 40, 20, 10, 5} <br/>
<var>p</var>(8) = {}<br />
Любое число, опровергающее гипотезу Коллатца, будет иметь бесконечно длинный префикс последовательности.
</p>
<p>
Пусть <var>S<sub>m</sub></var> будет множеством всех префиксов множества длиной <var>m</var>. Две последовательности {a<sub>1</sub>, a<sub>2</sub>, ..., a<sub><var>m</var></sub>}</var> и {b<sub>1</sub>, b<sub>2</sub>, ..., b<sub><var>m</var></sub>} в <var>S<sub>m</sub></var> будем считать принадлежащими к одному и тому же семейству префиксов при a<sub>i</sub> < a<sub>j</sub> в том и только том случае, если b<sub>i</sub> < b<sub>j</sub> для всех 1 &le; i,j &le;<var> m</var>.
</p>
<p>
Например, в <var>S</var><sub>4</sub> {6, 3, 10, 5} принадлежит к тому же семейству, что и {454, 227, 682, 341}, но не {113, 340, 170, 85}.<br />
Пусть <var>f(m)</var> будет количеством различных семейств префиксов в <var>S<sub>m</sub></var>.<br />
Вам дано, что <var>f</var>(5) = 5, <var>f</var>(10) = 55, <var>f</var>(20) = 6771.
</p>
<p>
Найдите <var>f</var>(90).
</p>

</div>