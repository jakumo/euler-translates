Subject:
Корни на подъеме

Body:
<div class="problem_content">
<p>Пусть <var>a</var><sub>k</sub>, <var>b</var><sub>k</sub> и <var>c</var><sub>k</sub> представляют три решения (вещественные или комплексные числа) для выражения 1/<var>x</var> = (<var>k</var>/<var>x</var>)<sup>2</sup>(<var>k</var> + <var>x</var><sup>2</sup>) - <var>kx</var>.</p>

<p>Например, для <var>k</var> = 5 мы видим, что {<var>a</var><sub>5</sub>, <var>b</var><sub>5</sub>, <var>c</var><sub>5</sub>} примерно равны {5.727244, -0.363622 + 2.057397i, -0.363622 - 2.057397i}.</p>

<p>Пусть S(<var>n</var>) = Σ (<var>a</var><sub><var>k</var></sub> + <var>b</var><sub><var>k</var></sub>)<sup><var>p</var></sup>(<var>b</var><sub><var>k</var></sub> + <var>c</var><sub><var>k</var></sub>)<sup><var>p</var></sup>(<var>c</var><sub><var>k</var></sub> + <var>a</var><sub><var>k</var></sub>)<sup><var>p</var></sup> для всех целых <var>p</var>, <var>k</var>, таких что 1 ≤ <var>p</var>, <var>k</var> ≤ <var>n</var>. </p>

<p>Интересно заметить, что S(<var>n</var>) всегда целое. Например, S(4) = 51160.</p>

<p>Найдите S(10<sup>6</sup>) modulo 1 000 000 007.</p>

</div>