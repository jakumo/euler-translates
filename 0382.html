Subject:
Генерирование многоугольников

Body:
<div class="problem_content">

<p>
<b>Многоугольник</b> - это плоская фигура, состоящая из соединенных между собой отрезков, образующих замкнутую цепь или контур. Многоугольник  состоит как минимум из трех сторон и не пересекает сам себя.
</p>

<p>
Множество положительных чисел S <i>генерирует многоугольник</i> P, если:
<ul>
<li> никакие две стороны P не имеют одинаковую длину,
<li> длина каждой стороны P содержится в S, и
<li> S не содержит никаких других значений.
</ul>
</p>

<p>
Например:
<br />
Множество {3, 4, 5} генерирует многоугольник со сторонами 3, 4 и 5 (треугольник).
<br />
Множество {6, 9, 11, 24} генерирует многоугольник со сторонами 6, 9, 11 и 24 (четырехугольник).
<br />
Множества {1, 2, 3} и {2, 3, 4, 9} не генерируют никакие многоугольники.
<br />
</p>

<p>
Рассмотрим последовательность s, определенную следующим образом:
<ul>
<li>s<sub>1</sub> = 1, s<sub>2</sub> = 2, s<sub>3</sub> = 3
<li>s<sub><var>n</var></sub> = s<sub><var>n</var>-1</sub> + s<sub><var>n</var>-3</sub> для <var>n</var> 
<img src='http://projecteuler.net/images/symbol_gt.gif' width='10' height='10' alt='&gt;' border='0' style='vertical-align:middle;' />
 3.
</ul>
</p>

<p>
Пусть U<sub><var>n</var></sub> будет множеством {s<sub>1</sub>, s<sub>2</sub>, ..., s<sub><var>n</var></sub>}. Например, U<sub>10</sub> = {1, 2, 3, 4, 6, 9, 13, 19, 28, 41}.
<br />
Пусть f(<var>n</var>) будет количеством подмножеств U<sub><var>n</var></sub>, которые генерируют хотя бы один многоугольник.
<br />
Например, f(5) = 7, f(10) = 501 и f(25) = 18635853.
</p>

<p>
Найдите последние 9 цифр f(10<sup>18</sup>).
</p>

</div>