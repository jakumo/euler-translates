Subject:
Последовательность точек на гиперболе

Body:
<div class="problem_content">

<p>Пусть H будет гиперболой, заданной уравнением 12<var>x</var><sup>2</sup> + 7<var>x</var><var>y</var> - 12<var>y</var><sup>2</sup> = 625.</p>

<p>Далее, определим X как точку (7, 1). Можно заметить, что X принадлежит H.</p>

<p>Теперь определим последовательность точек {P<sub><var>i</var></sub> : <var>i</var> <img src='http://projecteuler.net/images/symbol_ge.gif' width='10' height='12' alt='&ge;' border='0' style='vertical-align:middle;' /> 1} на гиперболе H следующим образом:
<ul>
<li> P<sub>1</sub> = (13, 61/4).
<li> P<sub>2</sub> = (-43/6, -4).
<li> Для <var>i</var> > 2, P<sub><var>i</var></sub> - это единственная точка на H отличная от P<sub><var>i</var>-1</sub> и такая, что прямая P<sub><var>i</var></sub>P<sub><var>i</var>-1</sub> параллельна прямой P<sub><var>i</var>-2</sub>X. Можно показать, что P<sub><var>i</var></sub> однозначно определена, и что ее координаты всегда рациональны.
</ul>
<img src='http://projecteuler.net/project/images/p422_hyperbola.gif'>
</p>

<p>Вам дано, что P<sub>3</sub>  = (-19/2, -229/24), P<sub>4</sub> = (1267/144, -37/12) и P<sub>7</sub> = (17194218091/143327232, 274748766781/1719926784).</p>

<p>Найдите P<sub><var>n</var></sub> для <var>n</var> = 11<sup>14</sup> следующим образом:<br>Если P<sub><var>n</var></sub> = (<var>a</var>/<var>b</var>, <var>c</var>/<var>d</var>), где дроби несократимы и их знаменатели положительны, то в качестве ответа приведите значение (<var>a</var> + <var>b</var> + <var>c</var> + <var>d</var>) mod 1&nbsp;000&nbsp;000&nbsp;007.</p>

<p>Для <var>n</var> = 7 ответ будет 806236837.</p>


</div>