Subject:
Пути в гору

Body:
<div class="problem_content">

<p>
Пусть <var>n</var> будет положительным целым числом. Представьте, что в координатах (<var>x</var>, <var>y</var>) = (2<sup><var>i</var></sup> mod <var>n</var>, 3<sup><var>i</var></sup> mod <var>n</var>) для 0 ≤ <var>i</var> ≤ 2<var>n</var> расположены станции. Будем считать станции с одинаковыми координатами одной и той же станцией.
</p><p>
Мы хотем проложить через существующие станции путь из (0, 0) в (<var>n</var>, <var>n</var>), причем такой, в котором координаты x и y никогда не уменьшаются.<br />
Пусть S(<var>n</var>) будет максимальным количеством станций, через которые такой путь может пройти.
</p><p>
Например, если <var>n</var> = 22, существует 11 различных станций, и удовлетворяющий условию путь может пройти через максимум 5 станций. Посему, S(22) = 5.
Этот случай проиллюстрирован ниже примером оптимального пути:
</p>
<p align="center"><img src="http://projecteuler.net/project/images/p411_longpath.png"></p>
<p>
Можно также показать, что S(123) = 14 и S(10000) = 48.
</p><p>
Найдите <span style="font-family:times new roman;font-size:13pt;">∑</span> S(<var>k</var><sup>5</sup>) для 1 ≤ <var>k</var> ≤ 30.
</p>

</div>
