Subject:
Анонимный Дед Мороз

Body:
<div class="problem_content">

<p>
Анонимный Дед Мороз - это процесс, позволяющий $n$ участникам подарить друг другу подарки так, что каждый дарит один подарок и получает один подарок. Вначале каждый из $n$ участников пишет свое имя на клочке бумаги и опускает его в шляпу. Затем каждый берет случайный клочок бумаги из шляпы. Если кто-то вытянул свое имя, он берет еще один случайный клочок и возвращает свое имя в шляпу. В конце каждый покупает рождественский подарок для человека, чье имя он вытянул. Однако, распределение не удастся, если последний тянувший получит свое же имя.
</p>
<p>
В данном варианте каждый из $n$ участников дарит и получает по два подарка. Вначале каждый пишет свое имя на двух клочках бумаги и кладет их в шляпу (всего в шляпе окажется $2n$ клочков бумаги). Как и раньше, каждый берет из шляпы случайный клочок бумаги с чужим именем. Потом тот же участник так же берет второе имя, получив в конце два случайных клочка бумаги, на которых не написано его имя. Затем следующий берет два клочка, и так далее. Распределение не удастся, если последний тянувший получит хотя бы один клочок бумаги со своим именем.
</p>
<p>
Определим $q(n)$ как вероятность такого провала. Известно, что $q(3) = 0.3611111111$ и $q(5) = 0.2476095994$, если оба числа округлить до 10 знака после десятичной точки.
</p>
<p>
Найдите $q(100)$, округленное до 10 знака после десятичной точки.
</p>
</div>