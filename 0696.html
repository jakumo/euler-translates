Subject:
Маджонг

Body:
<div class="problem_content">

<p>В игре Маджонг используются кости $s$ <i>мастей</i>. На каждой кости есть также <i>число</i> в промежутке $1\ldots n$, и для каждой комбинации масти и числа существует ровно четыре неотличимых кости с таким числом и мастью (настоящий маджонг также содержит другие дополнительные кости, но мы не рассматриваем их в этой задаче).</p>

<p><i>Выигрышной рукой</i> считается набор из $3t+2$ костей (где $t$ - определенное целое число), который можно разложить на $t$ <i>троек</i> и одну <i>пару</i>, где:</p>
<ul>
<li><i>Тройка</i> - это или <i>чоу</i>, или <i>панг</i></li>
<li><i>Чоу</i> - это три кости одной масти и последовательных чисел</li>
<li><i>Панг</i> - это три идентичные кости (одной масти и числа)</li>
<li><i>Пара</i> - это две идентичные кости (одной масти и числа)</li>
</ul>

<p>Например, ниже показана выигрышная рука при $n=9$, $s=3$, $t=4$, состоящая в данном случае из двух чоу, двух панг и одной пары:</p>
<div style="text-align:center;">
<img src="https://projecteuler.net/project/images/p696_mahjong_1.png" alt="Выигрышная рука в Маджонг" />
</div>

<p>Заметим, что иногда такой же набор костей можно представить как $t$ тройки и одну пару более, чем одним образом. Это считается только как одна выигрышная рука. Например, такой набор считается такой же выигрышной рукой, как в примере выше, так как он состоит из тех же костей:</p>
<div style="text-align:center;">
<img src="https://projecteuler.net/project/images/p696_mahjong_2.png" alt="Другая перестановка костей той же руки" />
</div>

<p>Пусть $w(n, s, t)$ будет количеством различных выигрышных рук, образованных из $t$ троек и одной пары, при $s$ возможных мастях и костях, пронумерованных от 1 до $n$.</p>

<p>Например, при одной единственной масти и числах от 1 до 4 мы получим $w(4, 1, 1) = 20$: существует 12 выигрышных рук, состоящих из панг и пары, и 8, состоящих из чоу и пары. Также известно, что $w(9, 1, 4) = 13259$, $w(9, 3, 4) = 5237550$ и $w(1000, 1000, 5) \equiv 107662178 \pmod{1\,000\,000\,007}$.</p>

<p>Найдите $w(10^8, 10^8, 30)$. В качестве ответа приведите остаток от деления полученного результата на $1\,000\,000\,007$.</p>

</div>