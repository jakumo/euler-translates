Subject:
Шифрование методом RSA

Body:
<div class="problem_content">
<p>Алгоритм шифрования RSA основывается на следующей процедуре:</p>
<p>Генерация двух различных простых чисел <var>p</var> и <var>q</var>.<br /> Вычисление <var>n=pq</var> и &phi;=

(<var>p</var>-1)(<var>q</var>-1).<br />
Поиск целого числа <var>e</var>, 1<img src='http://projecteuler.net/images/symbol_lt.gif' width='10' height='10'

alt='&lt;' border='0' style='vertical-align:middle;' /><var>e</var><img

src='http://projecteuler.net/images/symbol_lt.gif' width='10' height='10' alt='&lt;' border='0' style='vertical-

align:middle;' />&phi;, такого, что НОД(<var>e</var>,&phi;)=1.</p>
<p>Сообщение в этой системе представлено в виде числа, принадлежащего интервалу [0,<var>n</var>-1].<br />
Шифруемый текст каким-нибудь способом преобразовывается в  такие сообщения (числа, принадлежащие интервалу

[0,<var>n</var>-1]).<br />
Чтобы зашифровать текст, для каждого сообщения <var>m</var>, необходимо вычислить <var>c</var>=<var>m</var><img

src="" style="display:none;" alt="^(" /><sup><var>e</var></sup><img src="" style="display:none;" alt=")" /> mod

<var>n</var>.</p>
<p>Для дешифровки текста выполняется следующая процедура: найти такое <var>d</var>, чтобы <var>ed</var>=1 mod

&phi;, затем для каждого зашифрованного сообщения <var>c</var> вычислить <var>m=c<img src=""

style="display:none;" alt="^(" /><sup>d</sup><img src="" style="display:none;" alt=")" /></var> mod

<var>n</var>.</p>
<p>Существуют такие значения <var>e</var> и <var>m</var>, что <var>m<img src="" style="display:none;" alt="^("

/><sup>e</sup><img src="" style="display:none;" alt=")" /></var> mod <var>n=m</var>.<br />Сообщения <var>m</var>,

для которых <var>m<img src="" style="display:none;" alt="^(" /><sup>e</sup><img src="" style="display:none;"

alt=")" /></var> mod <var>n=m</var>, будем называть открытыми.</p>
<p>Проблема выбора <var>e</var> состоит в том, что не должно быть слишком много открытых сообщений.
<br />К примеру, пусть <var>p</var>=19 и <var>q</var>=37.<br />
Тогда <var>n</var>=19*37=703 и &phi;=18*36=648.<br />
Если выберем <var>e</var>=181, то, несмотря на то, что НОД(181,648)=1, окажется, что все возможные сообщения<br />
 <var>m</var> (0<img src='http://projecteuler.net/images/symbol_le.gif' width='10' height='12' alt='&le;'

border='0' style='vertical-align:middle;' /><var>m</var><img src='http://projecteuler.net/images/symbol_le.gif'

width='10' height='12' alt='&le;' border='0' style='vertical-align:middle;' /><var>n</var>-1) будут открытыми после

вычисления <var>m<img src="" style="display:none;" alt="^(" /><sup>e</sup><img src="" style="display:none;" alt=")"

/></var> mod <var>n</var>.<br />
Для любого верного выбора <var>e</var> существуют некоторые открытые сообщения.<br />
Важно, чтобы число таких открытых сообщений было минимальным.</p>
<p>Дано: <var>p</var>=1009 и <var>q</var>=3643.<br />
Найдите сумму всех значений <var>e</var>, 1<img src='http://projecteuler.net/images/symbol_lt.gif' width='10'

height='10' alt='&lt;' border='0' style='vertical-align:middle;' /><var>e</var><img

src='http://projecteuler.net/images/symbol_lt.gif' width='10' height='10' alt='&lt;' border='0' style='vertical-

align:middle;' />&phi;(1009,3643) и НОД(<var>e</var>,&phi;)=1, для которых число открытых сообщений будет

минимальным.</p>
</div>